---
output: 
  html_document:
    theme: spacelab
    keep_md: true
    toc: yes
    highlight: haddock
---

## Introduction

This is a cheatsheet for the R package [stargazer](https://sites.google.com/site/marekhlavac/stargazer). Stargazer simplifies the process of making well formatted 
regression and summary statistics tables. The credit for this great package 
belongs to [Marek Hlavac](https://sites.google.com/site/marekhlavac/).

I decided to make this cheatsheet after seeing Zev Ross' [ggplot2 cheatsheet](http://zevross.com/blog/2014/08/04/beautiful-plotting-in-r-a-ggplot2-cheatsheet-3/). I also want 
to mention two other very cool cheatsheets created by 
Garrett Grolemund over at [RStudio](http://www.rstudio.com/). Garrett made one 
for [R Markdown](http://shiny.rstudio.com/articles/rm-cheatsheet.html) and one 
for [Shiny](http://shiny.rstudio.com/articles/cheatsheet.html). Thank you for 
the inspiration Garrett and Zev!

Following Zev's lead, I'll setup a quick dataset and then run through iterations 
of code and the resulting stargazer output.

## Dataset: dplyr and nycflights13

Setting up a dataset for this cheatsheet allows me to spotlight two recent
R packages created by [Hadley Wickham](http://had.co.nz/). The first, 
[dplyr](https://github.com/hadley/dplyr), is a set of new tools for data 
manipulation. Using `dplyr`, I will extract flights and weather data from 
another new package called 
[nycflights13](https://github.com/hadley/nycflights13). With this data I 
will show how to estimate a couple of regression models and nicely format the 
results into tables with `stargazer`.

```{r, echo = TRUE, warning = FALSE, message = FALSE}
library(dplyr)
library(nycflights13)

library("AER") ## Applied Econometrics with R 

daily <- flights %>%
  filter(origin == "EWR") %>%
  group_by(year, month, day) %>%
  summarise(delay = mean(dep_delay, na.rm = TRUE))

daily_weather <- weather %>%
  filter(origin == "EWR") %>%
  group_by(year, month, day) %>%
  summarise(temp   = mean(temp, na.rm = TRUE),
            wind   = mean(wind_speed, na.rm = TRUE),
            precip = sum(precip, na.rm = TRUE))

both <- inner_join(daily, daily_weather)

## Create an indicator for quarter
both$quarter <- cut(both$month, breaks = c(0, 3, 6, 9, 12), 
                                labels = c("1", "2", "3", "4"))

## Create a vector of class logical
both$hot <- as.logical(both$temp > 85)

head(both)

```

We can use the `both` data frame to estimate a couple of linear models 
predicting the average delay out of Newark controlling for the weather. The 
first model will use only the weather variables and in the second I'll add 
dummy variables indicating the quarter. The raw R output:

```{r, echo = TRUE}
output  <- lm(delay ~ temp + wind + precip, data = both)
output2 <- lm(delay ~ temp + wind + precip + quarter, data = both)

## Instrumental variables model 
output3 <- ivreg(delay ~ temp + wind + precip| . - temp + hot, data = both)

summary(output)
summary(output2)

```

\
[Back to table of contents](#TOC)

## Quick note

Since I'm using [knitr](http://cran.rstudio.com/web/packages/knitr/index.html) 
and [R markdown](http://rmarkdown.rstudio.com/) to create this webpage, in the 
code that follows I will include the `stargazer` option `type = "html"`. 
`stargazer` is set to produce **LaTeX** output by default. If you desire 
**LaTeX** output, just remove the type option from the code below.

```{r, warning = FALSE, message = FALSE}
library(stargazer)
```

\
[Back to table of contents](#TOC)

## The default summary statistics table
```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
stargazer(both, type = "html")
```
  
When supplied a data frame, by default `stargazer` creates a table with summary 
statistics. If the `summary` option is set to `FALSE` then stargazer 
will instead print the contents of the data frame.

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
## Use only a few rows
both2 <- both[1:6, ]

stargazer(both2, type = "html", summary = FALSE)
```


### Change which statistics are displayed

In order to customize which summary statistics are displayed, change any of the
the following (logical) parameters, `nobs`, `mean.sd`, `min.max`, `median`, and
`iqr`. 

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
stargazer(both, type = "html", nobs = FALSE, mean.sd = TRUE, median = TRUE,
          iqr = TRUE)
```

### Change which statistics are displayed (a second way)

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
stargazer(both, type = "html", summary.stat = c("n", "p75", "sd"))
```

### Remove logical variables in the summary statistics

`stargazer` reports summary statistics for logical variables by default 
(0 = FALSE and 1 = TRUE). To supress the reporting of logical vectors change 
`summary.logical` to `FALSE`. Note the stats for our vector `hot` are gone. 

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
stargazer(both, type = "html", summary.logical = FALSE)
```

\
[Back to table of contents](#TOC)

## The default regression table

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
stargazer(output, output2, type = "html")
```

\
[Back to table of contents](#TOC)

## Change the style

`stargazer` includes several pre-formatted styles that imitate popular
academic journals. Simply change the `style` parameter.

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
stargazer(output, output2, type = "html", style = "qje")
```

\
[Back to table of contents](#TOC)

## Labelling the table

### Add a title; change the variable labels 

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
stargazer(output, output2, type = "html", 
          title            = "These are awesome results!",
          covariate.labels = c("Temperature", "Wind speed", "Rain (inches)",
                               "2nd quarter", "3rd quarter", "Fourth quarter"),
          dep.var.caption  = "A better caption",
          dep.var.labels   = "Flight delay (in minutes)")
```

### Exclude the dependent variable label or the model numbers

Note the dependent variable caption stays. To additionally remove the caption 
add `dep.var.caption = ""`.

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
stargazer(output, output2, type = "html", 
          dep.var.labels.include = FALSE,
          model.numbers          = FALSE)
```

### Change the column names

To change the column names just supply a character vector with the new labels, 
as shown below. 

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
stargazer(output, output2, type = "html", column.labels = c("Good", "Better"))
```

### Apply a label to more than one column

The option `column.separate` allows for assigning a label to more than one 
column. In this example I told `stargazer` to report each regression twice, for a
total of four columns. Using `column.separate`, `stargazer` now applies the first
label to the first two columns and the second label to the next two columns.

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
stargazer(output, output, output2, output2, type = "html", 
          column.labels   = c("Good", "Better"),
          column.separate = c(2, 2))
```

### Model names

When the results from different types of regression models (e.g., "OLS", 
"probit") are displayed in the same table `stargazer` adds a row indicating 
model type. Remove these labels by including `model.names = FALSE` (not shown).

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
stargazer(output, output3, type = "html")
```

\
[Back to table of contents](#TOC)

## Change the default output

### Report t-statistics or p-values instead of standard errors

Standard errors are reported by default. To report the t-statistics or
p-values instead, see the `report` argument. Notice that I've also moved the
star characters to the t-statistics instead of being next to the coefficients.

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
stargazer(output, output2, type = "html",
          report = "vct*")
```

### Report confidence intervals

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
stargazer(output, output2, type = "html",
          ci = TRUE)
```

### Adjust the confidence intervals
 
By default `ci.level = 0.95`. You may also change the character that separates 
the intervals with the `ci.separator` argument.

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
stargazer(output, output2, type = "html",
          ci = TRUE, ci.level = 0.90, ci.separator = " @@ ")
```

### Robust standard errors (Replicating Stata)

If you want to use robust standard errors (or clustered), `stargazer` allows 
for replacing the default output by supplying a new vector of values to the 
option `se`. For this example I will print the same model and adjust the 
standard errors in the first column with the `HC1` correction from the `sandwich`
package (i.e. the same correction Stata uses).

Similar options exits to make adjustments to the coefficients, t-statistics, 
or p-values. See `coef`, `t`, or `p`.

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}

library(sandwich)
cov1        <- vcovHC(output, type = "HC1")
robust.se   <- sqrt(diag(cov1))

stargazer(output, output, type = "html", 
          se = list(robust.se))
```

### Move the intercept term to the top of the table

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
stargazer(output, output2, type = "html",
          intercept.bottom = FALSE)
```

### Compress the table output

We can condense the table output by placing all the the output on the same row.
When `single.row` is set to `TRUE`, the argument `no.space` is automatically 
set to `TRUE`.

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
stargazer(output, output2, type = "html",
          single.row = TRUE)
```

\
[Back to table of contents](#TOC)

## Omit parts of the default output

In fixed effect model specifications it is often undesirable to report the 
fixed effect coefficients. To omit any coefficient, supply a regular 
expression to `omit`.

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
stargazer(output, output2, type = "html", omit = "quarter")
```

### Reporting omitted variables

Add the `omit.labels` parameter to report which variables have been omitted. 
Must be the same length as the number of regular expressions supplied to `omit`.
By default `omit.labels` reports "Yes" or "No". To change this supply 
a new vector of length 2 to `omit.yes.no = c("Yes", "No")`.

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
stargazer(output, output2, type = "html", 
          omit        = "quarter",
          omit.labels = "Quarter dummies?")
```

### Omit parts of the regression output

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
## Remove r-square and f-statistic
stargazer(output, output2, type = "html", 
          omit.stat = c("rsq", "f"))
```

### Omit whole parts of the table

The argument `table.layout` accepts a character string that tells `stargazer` 
which table elements to **include**. 

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
## Remove statistics and notes sections completely
stargazer(output, output2, type = "html", 
          table.layout = "#t")
```

### Omit whole parts of the table (a second way)

Use to `omit.table.layout` to specify table elements to remove. Identical to 
the example directly above.

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
## Remove statistics and notes sections completely
stargazer(output, output2, type = "html", 
          omit.table.layout = "sn")
```

\
[Back to table of contents](#TOC)

## Statistical significance options

By default `stargazer` uses \*\*\*, \*\*, and \* to denote statistical 
significance at the one, five, and ten percent levels. This behavior can be 
changed by altering the `star.char` option. 

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
## Remove statistics and notes sections completely
stargazer(output, output2, type = "html", 
          star.char = c("@", "@@", "@@@"))
```

### Change the cutoffs for significance

Notice that temperature, quarter3, and quarter4 have each lost a gold star 
because we made it tougher to earn them.

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
## Remove statistics and notes sections completely
stargazer(output, output2, type = "html", 
          star.cutoffs = c(0.05, 0.01, 0.001)) # star.cutoffs = NULL by default
```

\
[Back to table of contents](#TOC)

## Modifying table notes

### Make an addition to the existing note section

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
## Remove r-square and f-statistic
stargazer(output, output2, type = "html", 
          notes = "I make this look good!")
```

### Replace the note section

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
## Remove r-square and f-statistic
stargazer(output, output2, type = "html", 
          notes        = "Sometimes you just have to start over.", 
          notes.append = FALSE)
```

### Change note alignment

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
## Remove r-square and f-statistic
stargazer(output, output2, type = "html", 
          notes.align = "l")
```

### Change the note section label

```{r, echo = TRUE, warning = FALSE, message = FALSE, results='asis'}
## Remove r-square and f-statistic
stargazer(output, output2, type = "html", 
          notes.label = "New note label")
```

\
[Back to table of contents](#TOC)




